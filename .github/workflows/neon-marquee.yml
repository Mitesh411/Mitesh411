name: Neon Marquee Contributions

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

concurrency:
  group: neon-marquee
  cancel-in-progress: true

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash

    steps:
      - uses: actions/checkout@v4

      - name: Download contribution chart
        run: |
          # fail early on network error, follow redirects, be quiet except on error
          curl --fail --show-error --silent -L -o contrib.svg "https://ghchart.rshah.org/${{ github.repository_owner }}"

      - name: Generate Neon Marquee SVG
        run: |
          cat > neon-marquee.svg <<'SVG'
          <svg xmlns="http://www.w3.org/2000/svg" width="1200" height="220">

          <style>
          .text {
            font: bold 28px monospace;
            fill: #39ff14;
            filter: drop-shadow(0 0 6px #39ff14) drop-shadow(0 0 12px #39ff14);
          }

          .marquee {
            animation: scroll 12s linear infinite;
          }

          @keyframes scroll {
            from { transform: translateX(100%); }
            to { transform: translateX(-100%); }
          }
          </style>

          <g class="marquee">
            <text x="0" y="35" class="text">
              Mitesh411 • GitHub Contributions • Mitesh411 • GitHub Contributions
            </text>

            <image href="contrib.svg" x="0" y="55" height="140"/>
          </g>

          </svg>
          SVG

      - name: Push to output branch
        uses: crazy-max/ghaction-github-pages@v3
        with:
          target_branch: output
          build_dir: .
          create_branch: true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
